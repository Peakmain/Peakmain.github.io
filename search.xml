<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Gradle+ASMå®æˆ˜â€”â€”éšç§æ–¹æ³•é—®é¢˜å½»åº•è§£å†³ä¹‹AsmActualCombatå¼€æºåº“</title>
      <link href="/archives/e7b8587f.html"/>
      <url>/archives/e7b8587f.html</url>
      
        <content type="html"><![CDATA[<h1 id="AsmActualCombat"><a href="#AsmActualCombat" class="headerlink" title="AsmActualCombat"></a>AsmActualCombat</h1><ul><li>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/Peakmain/AsmActualCombat">https://github.com/Peakmain/AsmActualCombat</a></li><li><strong>ä½¿ç”¨æ–‡æ¡£é“¾æ¥</strong>:<a href="https://github.com/Peakmain/AsmActualCombat/wiki">https://github.com/Peakmain/AsmActualCombat/wiki</a></li></ul><h3 id="åŠŸèƒ½ä»‹ç»"><a href="#åŠŸèƒ½ä»‹ç»" class="headerlink" title="åŠŸèƒ½ä»‹ç»"></a>åŠŸèƒ½ä»‹ç»</h3><h4 id="ASMå…¨åŸ‹ç‚¹åŠŸèƒ½"><a href="#ASMå…¨åŸ‹ç‚¹åŠŸèƒ½" class="headerlink" title="ASMå…¨åŸ‹ç‚¹åŠŸèƒ½"></a>ASMå…¨åŸ‹ç‚¹åŠŸèƒ½</h4><ul><li> $AppStartäº‹ä»¶ï¼šåº”ç”¨ç¨‹åºå¯åŠ¨å¯åŠ¨äº‹ä»¶ã€‚</li><li> $AppEndäº‹ä»¶:åº”ç”¨ç¨‹åºé€€å‡ºäº‹ä»¶ã€‚</li><li>$AppViewScreenäº‹ä»¶:åº”ç”¨ç¨‹åºé¡µé¢æµè§ˆäº‹ä»¶</li><li>$AppClick äº‹ä»¶:åº”ç”¨ç¨‹åºæ§ä»¶ï¼ˆViewï¼‰ç‚¹å‡»äº‹ä»¶,å¦‚:ImageView,Button,Dialogç­‰</li><li>é»˜è®¤åŒ…å«é˜²æ­¢å¤šæ¬¡ç‚¹å‡»äº‹ä»¶çš„å¤„ç†</li><li>å¯åŠ¨æ€è®¾ç½®æ–¹æ³•å¯¹ç‚¹å‡»äº‹ä»¶å¤„ç†ä¹‹å‰è¿›è¡Œæ‹¦æˆªï¼Œç›®å‰åªæ”¯æŒå¯¹setOnClickListenerè¿›è¡Œæ‹¦æˆª<h4 id="éšç§æ–¹æ³•è°ƒç”¨å¤„ç†"><a href="#éšç§æ–¹æ³•è°ƒç”¨å¤„ç†" class="headerlink" title="éšç§æ–¹æ³•è°ƒç”¨å¤„ç†"></a>éšç§æ–¹æ³•è°ƒç”¨å¤„ç†</h4></li><li>å¯¹è°ƒç”¨éšç§æ–¹æ³•çš„æ–¹æ³•ä½“æ›¿æ¢æˆè‡ªå·±çš„æ–¹æ³•(æ”¯æŒåŠ¨æ€æ›¿æ¢æ–¹æ³•)ï¼Œå¦‚ï¼šè®¾å¤‡id,Macåœ°å€ç­‰</li></ul><h4 id="è¾…åŠ©åŠŸèƒ½"><a href="#è¾…åŠ©åŠŸèƒ½" class="headerlink" title="è¾…åŠ©åŠŸèƒ½"></a>è¾…åŠ©åŠŸèƒ½</h4><ul><li>å¯è·å–æ–¹æ³•çš„è€—æ—¶æ—¶é—´</li><li>æ‰“å°æ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼</li><li>æ‰“å°æ–¹æ³•çš„Frame</li><li>å¯åŠ¨æ€é…ç½®æ˜¯å¦å¼€å¯æ’ä»¶ï¼Œé»˜è®¤æ˜¯å¼€å¯</li></ul><h3 id="æ€æ ·ä½¿ç”¨"><a href="#æ€æ ·ä½¿ç”¨" class="headerlink" title="æ€æ ·ä½¿ç”¨"></a>æ€æ ·ä½¿ç”¨</h3><p><strong>ASMæ’ä»¶ä¾èµ–</strong><br>Add it in your root build.gradle at the end of repositories:</p><figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">buildscript &#123;<br>  repositories &#123;<br>    maven &#123;<br>      url <span class="hljs-string">&quot;https://plugins.gradle.org/m2/&quot;</span><br>    &#125;<br>  &#125;<br>  dependencies &#123;<br>    classpath <span class="hljs-string">&quot;io.github.peakmain:plugin:1.1.1&quot;</span><br>  &#125;<br>&#125;<br>apply <span class="hljs-attr">plugin:</span> <span class="hljs-string">&quot;com.peakmain.plugin&quot;</span><br></code></pre></td></tr></table></figure><p><strong>æ‹¦æˆªäº‹ä»¶sdkçš„ä¾èµ–</strong></p><ul><li>Step 1. Add the JitPack repository to your build file<br>Add it in your root build.gradle at the end of repositories:<figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">allprojects &#123;<br>repositories &#123;<br>...<br>maven &#123; url <span class="hljs-string">&#x27;https://jitpack.io&#x27;</span> &#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>Step 2. Add the dependency<figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">dependencies &#123;<br>       implementation <span class="hljs-string">&#x27;com.github.Peakmain:AsmActualCombat:1.1.1&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨æ–‡æ¡£"><a href="#ä½¿ç”¨æ–‡æ¡£" class="headerlink" title="ä½¿ç”¨æ–‡æ¡£"></a>ä½¿ç”¨æ–‡æ¡£</h3><h4 id="Applicationä¸­åˆå§‹åŒ–"><a href="#Applicationä¸­åˆå§‹åŒ–" class="headerlink" title="Applicationä¸­åˆå§‹åŒ–"></a>Applicationä¸­åˆå§‹åŒ–</h4><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">SensorsDataAPI.init(<span class="hljs-built_in">this</span>);<br></code></pre></td></tr></table></figure><h4 id="åŠ¨æ€è®¾ç½®æ˜¯å¦å¼€å¯æ’ä»¶"><a href="#åŠ¨æ€è®¾ç½®æ˜¯å¦å¼€å¯æ’ä»¶" class="headerlink" title="åŠ¨æ€è®¾ç½®æ˜¯å¦å¼€å¯æ’ä»¶"></a>åŠ¨æ€è®¾ç½®æ˜¯å¦å¼€å¯æ’ä»¶</h4>åœ¨gradle.propertiesä¸­è®¾ç½®ä»¥ä¸‹å‚æ•°ï¼Œfalseä»£è¡¨ä¸å…³é—­æ’ä»¶ï¼Œtrueè¡¨ç¤ºå…³é—­æ’ä»¶ï¼Œé»˜è®¤æ˜¯false<figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">peakmainPlugin.disableAppClick=<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="æ•°æ®å…¨åŸ‹ç‚¹æ¥å£ä¸Šä¼ "><a href="#æ•°æ®å…¨åŸ‹ç‚¹æ¥å£ä¸Šä¼ " class="headerlink" title="æ•°æ®å…¨åŸ‹ç‚¹æ¥å£ä¸Šä¼ "></a>æ•°æ®å…¨åŸ‹ç‚¹æ¥å£ä¸Šä¼ </h4><ul><li><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">SensorsDataAPI.getInstance().setOnUploadSensorsDataListener &#123; state: Int, data: String -&gt;<br>    when (state) &#123;<br>            <span class="hljs-comment">//$AppStartäº‹ä»¶</span><br>        SensorsDataConstants.APP_START_EVENT_STATE,<br>            <span class="hljs-comment">//$AppEndäº‹ä»¶</span><br>        SensorsDataConstants.APP_END__EVENT_STATE,<br>            <span class="hljs-comment">//$AppViewScreenäº‹ä»¶</span><br>        SensorsDataConstants.APP_VIEW_SCREEN__EVENT_STATE,<br>            <span class="hljs-comment">//$AppClick äº‹ä»¶</span><br>        SensorsDataConstants.APP_VIEW_CLICK__EVENT_STATE<br>        -&gt; <span class="hljs-keyword">if</span> (BuildConfig.DEBUG) &#123;<br>            Log.e(<span class="hljs-string">&quot;TAG&quot;</span>, <span class="hljs-string">&quot;åŸ‹ç‚¹\n$data&quot;</span>)<br>        &#125;<br>        <span class="hljs-keyword">else</span> -&gt; <span class="hljs-keyword">if</span> (BuildConfig.DEBUG) &#123;<br>            Log.e(<span class="hljs-string">&quot;TAG&quot;</span>, data)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="åœ¨è¦æ‹¦æˆªçš„é¡µé¢è®¾ç½®æ‹¦æˆªäº‹ä»¶"><a href="#åœ¨è¦æ‹¦æˆªçš„é¡µé¢è®¾ç½®æ‹¦æˆªäº‹ä»¶" class="headerlink" title="åœ¨è¦æ‹¦æˆªçš„é¡µé¢è®¾ç½®æ‹¦æˆªäº‹ä»¶"></a>åœ¨è¦æ‹¦æˆªçš„é¡µé¢è®¾ç½®æ‹¦æˆªäº‹ä»¶</h4></li><li>éœ€è¦åœ¨app.gradleä¸­æ·»åŠ æ‹¦æˆªåŒ…åå‰ç¼€,æ¯”å¦‚æˆ‘çš„é¡¹ç›®å‰ç¼€æ˜¯com.peakmain<figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">monitorPlugin &#123;<br>     ...<br>    interceptPackageName = <span class="hljs-string">&quot;com.peakmain&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>ç›®å‰åªæ”¯æŒsetOnClickListeneräº‹ä»¶æ‹¦æˆª<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">SensorsDataAPI.getInstance().setOnUserAgreementListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SensorsDataAPI</span>.OnUserAgreementListener() &#123;<br>          <span class="hljs-meta">@Override</span><br>           <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onUserAgreement</span><span class="hljs-params">()</span> &#123;<br>           <br>       &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>å®Œæ•´çš„ä¸¾ä¾‹ä»£ç å¦‚ä¸‹ï¼š<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUserAgreementListener</span><span class="hljs-params">(Activity activity)</span> &#123;<br>    isAcceptUserPrivacy = (Boolean) PreferencesUtils.getInstance(<span class="hljs-built_in">this</span>).getParam(Constants.HAS_ACCEPT_USER_PRIVACY, <span class="hljs-literal">false</span>);<br>    SensorsDataAPI.getInstance().setOnUserAgreementListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SensorsDataAPI</span>.OnUserAgreementListener() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onUserAgreement</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">if</span> (!isAcceptUserPrivacy) &#123;<br>                <span class="hljs-comment">//æ²¡æœ‰åŒæ„</span><br>                <span class="hljs-type">AlertDialog</span> <span class="hljs-variable">dialog</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AlertDialog</span>.Builder(activity)<br>                        .setContentView(R.layout.dialog_user_agreement)<br>                        .setCancelable(<span class="hljs-literal">false</span>)<span class="hljs-comment">//ç‚¹å‡»ç©ºç™½ä¸å¯å–æ¶ˆ</span><br>                        .show();<br>                 <span class="hljs-comment">//è®¾ç½®ç”¨æˆ·åè®®çš„æ‹¦æˆªäº‹ä»¶ä¸ºNULL</span><br>                SensorsDataAPI.getInstance().setOnUserAgreementListener(<span class="hljs-literal">null</span>);<br>                dialog.setOnClickListener(R.id.stv_refuse, v -&gt; &#123;<br>                    <span class="hljs-comment">//å–æ¶ˆæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span><br>                    dialog.dismiss();<br>                    setUserAgreementListener(activity);<br>                &#125;);<br>                dialog.setOnClickListener(R.id.stv_agreement, v -&gt; &#123;<br>                <span class="hljs-comment">//åŒæ„æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span><br>                    com.peakmain.ui.utils.ToastUtils.showLong(<span class="hljs-string">&quot;åŒæ„äº†&quot;</span>);<br>                    PreferencesUtils.getInstance(activity).saveParams(Constants.HAS_ACCEPT_USER_PRIVACY, <span class="hljs-literal">true</span>);<br>                    dialog.dismiss();<br>                  <br>                &#125;);<br>            &#125;<br>            <span class="hljs-keyword">return</span> isAcceptUserPrivacy;<br>        &#125;<br>    &#125;);<br></code></pre></td></tr></table></figure><h4 id="è·å–æ–¹æ³•è€—æ—¶æ—¶é—´å’Œæ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼"><a href="#è·å–æ–¹æ³•è€—æ—¶æ—¶é—´å’Œæ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼" class="headerlink" title="è·å–æ–¹æ³•è€—æ—¶æ—¶é—´å’Œæ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼"></a>è·å–æ–¹æ³•è€—æ—¶æ—¶é—´å’Œæ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼</h4>åœ¨éœ€è¦è·å–è€—æ—¶æ—¶é—´çš„æ–¹æ³•ä¸Šæ–¹æ·»åŠ ä»¥ä¸‹æ³¨è§£<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(&#123;ElementType.METHOD&#125;)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> LogMessage &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ˜¯å¦æ‰“å°æ–¹æ³•è€—æ—¶æ—¶é—´</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLogTime</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * æ˜¯å¦æ‰“å°æ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLogParametersReturnValue</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-literal">false</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="è·å–æ–¹æ³•è€—æ—¶æ—¶é—´"><a href="#è·å–æ–¹æ³•è€—æ—¶æ—¶é—´" class="headerlink" title="è·å–æ–¹æ³•è€—æ—¶æ—¶é—´"></a>è·å–æ–¹æ³•è€—æ—¶æ—¶é—´</h5>å¦‚æœæƒ³è·å–æ–¹æ³•è€—æ—¶æ—¶é—´ï¼Œåˆ™éœ€è¦è®¾ç½®æ³¨è§£å‚æ•°isLogTimeä¸ºtrueï¼Œå¦‚ï¼š<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@LogMessage(isLogTime = true)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMethodTime</span><span class="hljs-params">(<span class="hljs-type">long</span> l)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;getMethod&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707405132AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%931.png" alt="image.png"><h5 id="æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼"><a href="#æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼" class="headerlink" title="æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼"></a>æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼</h5>å¦‚æœæƒ³æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼ï¼Œåˆ™éœ€è¦è®¾ç½®æ³¨è§£å‚æ•°isLogParametersReturnValue,å¦‚:<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@LogMessage(isLogParametersReturnValue = true)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMethodParametersReturnValue</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;treasure&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707407131AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%932.png" alt="image.png"><h5 id="è·å–æ–¹æ³•è€—æ—¶çš„åŒæ—¶æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼"><a href="#è·å–æ–¹æ³•è€—æ—¶çš„åŒæ—¶æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼" class="headerlink" title="è·å–æ–¹æ³•è€—æ—¶çš„åŒæ—¶æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼"></a>è·å–æ–¹æ³•è€—æ—¶çš„åŒæ—¶æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼</h5>ä¹Ÿå¯æ”¯æŒè·å–æ–¹æ³•è€—æ—¶çš„åŒæ—¶æ‰“å°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@LogMessage(isLogTime = true, isLogParametersReturnValue = true)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;peakmain&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707408131AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%933.png" alt="image.png"><h4 id="æ‰“å°æ–¹æ³•çš„Frame"><a href="#æ‰“å°æ–¹æ³•çš„Frame" class="headerlink" title="æ‰“å°æ–¹æ³•çš„Frame"></a>æ‰“å°æ–¹æ³•çš„Frame</h4></li><li>1ã€å¼€å¯å †æ ˆåˆ†æï¼Œé»˜è®¤æ˜¯ç¦ç”¨,falseè¡¨ç¤ºå¼€å¯ï¼Œtrueè¡¨ç¤ºç¦ç”¨<figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">monitorPlugin &#123;<br>    disableStackMapFrame = <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li>2ã€å¦‚æœæƒ³æ‰“å°æ–¹æ³•çš„Frameï¼Œåªéœ€è¦åœ¨æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£@LogFrameInfoï¼Œå¦‚:<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@LogFrameInfo</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">testLogMethodStackMapFrame</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>        e.printStackTrace();<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;peakmain&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="æ›¿æ¢æ–¹æ³•ä½“"><a href="#æ›¿æ¢æ–¹æ³•ä½“" class="headerlink" title="æ›¿æ¢æ–¹æ³•ä½“"></a>æ›¿æ¢æ–¹æ³•ä½“</h4><h5 id="é»˜è®¤æ”¯æŒæ›¿æ¢çš„æ–¹æ³•"><a href="#é»˜è®¤æ”¯æŒæ›¿æ¢çš„æ–¹æ³•" class="headerlink" title="é»˜è®¤æ”¯æŒæ›¿æ¢çš„æ–¹æ³•"></a>é»˜è®¤æ”¯æŒæ›¿æ¢çš„æ–¹æ³•</h5><p><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707409129AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%934.png" alt="image.png"></p><h5 id="ç™½åå•"><a href="#ç™½åå•" class="headerlink" title="ç™½åå•"></a>ç™½åå•</h5><p>å¦‚æœæƒ³è®©æŸä¸ªç±»ä¸è¢«æ›¿æ¢ï¼Œå¯ä»¥åœ¨whiteListä¸­æ·»åŠ ï¼Œå¦‚ï¼š</p><figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">monitorPlugin &#123;<br>    whiteList = [<br>            <span class="hljs-string">&quot;com.peakmain.asmactualcombat.utils.TestUtils&quot;</span>,<br>            <span class="hljs-string">&quot;com.peakmain.plugin&quot;</span><br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><strong>å¿…é¡»å†™åˆ°å…·ä½“æŸä¸ªç±»</strong>,åªå†™åˆ°åŒ…åä¸å¯ç”¨ï¼Œå¦‚ï¼šä¸Šé¢ä»£ç å†™åˆ°com.peakmain.asmactualcombat.utilså¹¶ä¸èƒ½èµ·åˆ°ç™½åå•ä½œç”¨</p></blockquote><h5 id="æ›¿æ¢æ–¹æ³•ä½“-1"><a href="#æ›¿æ¢æ–¹æ³•ä½“-1" class="headerlink" title="æ›¿æ¢æ–¹æ³•ä½“"></a>æ›¿æ¢æ–¹æ³•ä½“</h5><h6 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h6><ul><li>ä½¿ç”¨æ–¹å¼app.gradleä¸­è®¾ç½®methodStatusä¸º1<figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">monitorPlugin &#123;<br>    methodStatus = <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><h6 id="è‡ªå®šä¹‰æ›¿æ¢æ–¹æ³•çš„è¿”å›å€¼"><a href="#è‡ªå®šä¹‰æ›¿æ¢æ–¹æ³•çš„è¿”å›å€¼" class="headerlink" title="è‡ªå®šä¹‰æ›¿æ¢æ–¹æ³•çš„è¿”å›å€¼"></a>è‡ªå®šä¹‰æ›¿æ¢æ–¹æ³•çš„è¿”å›å€¼</h6><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">SensorsDataAPI.getInstance().setOnReplaceMethodListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OnReplaceMethodListener</span>() &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onReplaceMethodListener</span><span class="hljs-params">(<span class="hljs-type">int</span> telephoneState, TelephonyManager manager, <span class="hljs-type">int</span> slotIndex)</span> &#123;<br>        <span class="hljs-keyword">switch</span> (telephoneState) &#123;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_DEVICE_ID:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_DEVICE_ID&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_MEID:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_MEID&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_IMEI:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_IMEI&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_SUBSCRIBER_ID:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_SUBSCRIBER_ID&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_SIM_SERIAL_NUMBER:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_SIM_SERIAL_NUMBER&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onReplaceMethodListener</span><span class="hljs-params">(<span class="hljs-type">int</span> wifiInfoState, WifiInfo wifiInfo)</span> &#123;<br>        <span class="hljs-keyword">switch</span> (wifiInfoState) &#123;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_MAC_ADDRESS:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_MAC_ADDRESS&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_SSID:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_SSID&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_BSSID:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_SSIDGET_BSSID&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> SensorsDataConstants.GET_IP_ADDRESS:<br>                LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢GET_IP_ADDRESS&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> WifiInfo <span class="hljs-title function_">onReplaceMethodListener</span><span class="hljs-params">(WifiManager wifiManager)</span> &#123;<br>        LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢WifiManager&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onReplaceMethodListener</span><span class="hljs-params">(SubscriptionInfo subscriptionInfo)</span> &#123;<br>        LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢SubscriptionInfo&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;PackageInfo&gt; <span class="hljs-title function_">onReplaceMethodListener</span><span class="hljs-params">(PackageManager manager)</span> &#123;<br>        LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢PackageManager&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onReplaceMethodListener</span><span class="hljs-params">(ContentResolver resolver, String name)</span> &#123;<br>        LogUtils.e(<span class="hljs-string">&quot;æ›¿æ¢ContentResolver&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;onReplaceMethodListener&quot;</span>;<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h5 id="éªŒè¯æ›¿æ¢æ–¹æ³•ä½“"><a href="#éªŒè¯æ›¿æ¢æ–¹æ³•ä½“" class="headerlink" title="éªŒè¯æ›¿æ¢æ–¹æ³•ä½“"></a>éªŒè¯æ›¿æ¢æ–¹æ³•ä½“</h5>ä¸ºäº†éªŒè¯ï¼Œæˆ‘APPå¼•å…¥äº†æå…‰æ¨é€çš„</li></ul><h6 id="æœªä½¿ç”¨å‰"><a href="#æœªä½¿ç”¨å‰" class="headerlink" title="æœªä½¿ç”¨å‰"></a>æœªä½¿ç”¨å‰</h6><p><strong>è‡ªèº«çš„APP</strong><br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707410129AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%935.png" alt="image.png"><br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707411129AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%936.png" alt="image.png"><br><strong>æå…‰</strong><br>å…³äºæå…‰ï¼Œå¤§å®¶å¯ä»¥çœ‹è¿™å‡ ä¸ªç±»çš„ç›¸å…³æ–¹æ³•</p><ul><li><p>cn/jiguang/an/dçš„getConnectionInfo</p></li><li><p>cn/jiguang/ap/fçš„getConnectionInfo</p></li><li><p>cn/jiguang/l/bçš„getConnectionInfo</p></li><li><p>cn/jiguang/w/cçš„getDeviceId</p></li><li><p>cn/jiguang/f/açš„getDeviceId</p></li><li><p>cn/jiguang/f/açš„getConnectionInfo</p></li><li><p>cn/jiguang/f/açš„getMacAddress</p></li><li><p>cn/jiguang/w/dçš„getDeviceId</p></li><li><p>æˆ‘å°±ä¸å¸¦å¤§å®¶çœ‹æ‰€æœ‰çš„äº†ï¼Œæˆ‘ä»¬æŒ‘å‡ ä¸ª<br>çœ‹cn/jiguang/f/açš„getMacAddresså’Œcn/jiguang/f/açš„getDeviceId</p></li><li><p>å› ä¸ºæˆ‘ä»¬çœ‹ä¸åˆ°æºç ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡å­—èŠ‚ç å»çœ‹<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707412128AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%937.png" alt="image.png"><br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707413129AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%938.png" alt="image.png"></p><h6 id="ä½¿ç”¨æ›¿æ¢å"><a href="#ä½¿ç”¨æ›¿æ¢å" class="headerlink" title="ä½¿ç”¨æ›¿æ¢å"></a>ä½¿ç”¨æ›¿æ¢å</h6></li><li><p>æ·»åŠ ä¾èµ–,appçš„build.gradle</p><figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">monitorPlugin &#123;<br>    whiteList = [<br>            <span class="hljs-string">&quot;com.peakmain.asmactualcombat.utils.TestUtils&quot;</span>,<br>            <span class="hljs-string">&quot;com.peakmain.plugin&quot;</span><br>    ]<br>    methodStatus = <span class="hljs-number">1</span><span class="hljs-comment">//æ›¿æ¢æ–¹æ³•ä½“</span><br>    disableStackMapFrame = <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><p><strong>è‡ªèº«App</strong><br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707414128AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%939.png" alt="image.png"><br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707415128AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%9310.png" alt="image.png"></p><p>å¯ä»¥å‘ç°ç™½åå•ç”Ÿæ•ˆäº†</p><p><strong>æå…‰æ¨é€</strong><br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707416130AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%9311.png" alt="image.png"><br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/Gradle+ASM%E5%AE%9E%E6%88%98/1653707417130AsmActualCombat%E5%BC%80%E6%BA%90%E5%BA%9312.png" alt="image.png"></p><h4 id="å…³äºæˆ‘"><a href="#å…³äºæˆ‘" class="headerlink" title="å…³äºæˆ‘"></a>å…³äºæˆ‘</h4><ul><li>æˆ‘çš„Github:<a href="https://github.com/peakmain">https://github.com/peakmain</a></li><li>æˆ‘çš„ç®€ä¹¦:<a href="https://www.jianshu.com/u/3ff32f5aea98">https://www.jianshu.com/u/3ff32f5aea98</a></li><li>æˆ‘çš„æ˜é‡‘:<a href="https://juejin.cn/user/175532853176152">https://juejin.cn/user/175532853176152</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Gradleå’ŒASM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gradle </tag>
            
            <tag> asm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BasicLibraryâ€”â€”åŸºäºkotlin+jetpack+mvvmå°è£…ä¸€å¥—æ¡†æ¶ï¼Œæé«˜Androidå¼€å‘æ•ˆç‡</title>
      <link href="/archives/85ddffd8.html"/>
      <url>/archives/85ddffd8.html</url>
      
        <content type="html"><![CDATA[<h3 id="BasicLibrary"><a href="#BasicLibrary" class="headerlink" title="BasicLibrary"></a>BasicLibrary</h3><ul><li>BasicLibraryæ˜¯åŸºäºkotlin+jetpack+mvvmå°è£…çš„ä¸€å¥—æ¡†æ¶,æé«˜Androidå¼€å‘æ•ˆç‡</li><li>é›†æˆäº†è‡ªå·±å°è£…çš„BasicUIåº“ï¼Œå…³äºBasicUIå¤§å®¶å¯ä»¥çœ‹æˆ‘ä¹‹å‰å†™çš„æ–‡ç« <a href="https://www.jianshu.com/p/78bcc6c3bbca">BasicUIå¸¸ç”¨UIç»„ä»¶å’Œå®ç”¨å·¥å…·ç±»å°è£…ï¼Œæé«˜Androidå¼€å‘çš„æ•ˆç‡</a></li></ul><p>è¿˜åŒ…æ‹¬:</p><ul><li>MMKVçš„å°è£…</li><li>é˜²æ­¢å¤šæ¬¡ç‚¹å‡»äº‹ä»¶çš„å¤„ç†</li><li>Retrofitå°è£…å®ç°ç½‘ç»œè§£è€¦</li><li>çº¿ç¨‹çš„åˆ‡æ¢ï¼ŒViewçš„æŠ–åŠ¨æ•ˆæœ</li><li>LiveDataå®ç°äº‹ä»¶åˆ†å‘æ€»çº¿</li><li>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/Peakmain/BasicLibrary">https://github.com/Peakmain/BasicLibrary</a></li></ul><h3 id="æ€æ ·ä½¿ç”¨"><a href="#æ€æ ·ä½¿ç”¨" class="headerlink" title="æ€æ ·ä½¿ç”¨"></a>æ€æ ·ä½¿ç”¨</h3><h4 id="Step-1-Add-the-JitPack-repository-to-your-build-file"><a href="#Step-1-Add-the-JitPack-repository-to-your-build-file" class="headerlink" title="Step 1. Add the JitPack repository to your build file"></a>Step 1. Add the JitPack repository to your build file</h4><ul><li>Add it in your root build.gradle at the end of repositories:<figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">allprojects &#123;<br>repositories &#123;<br>...<br>maven &#123; url <span class="hljs-string">&#x27;https://jitpack.io&#x27;</span> &#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="Step-2-Add-the-dependency"><a href="#Step-2-Add-the-dependency" class="headerlink" title="Step 2. Add the dependency"></a>Step 2. Add the dependency</h4><p>-</p><figure class="highlight groovy"><table><tr><td class="code"><pre><code class="hljs groovy">dependencies &#123;<br>        implementation <span class="hljs-string">&#x27;com.github.Peakmain:BasicLibrary:1.0.4&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½åˆ—è¡¨"><a href="#åŠŸèƒ½åˆ—è¡¨" class="headerlink" title="åŠŸèƒ½åˆ—è¡¨"></a>åŠŸèƒ½åˆ—è¡¨</h3><h4 id="é›†æˆBaseActivity"><a href="#é›†æˆBaseActivity" class="headerlink" title="é›†æˆBaseActivity"></a>é›†æˆBaseActivity</h4><ul><li><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">XXActivity</span></span>(<span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> layoutId: <span class="hljs-built_in">Int</span> = è‡ªå®šä¹‰å¸ƒå±€) :<br>    BaseActivity&lt;T : ViewDataBinding, E : BaseViewModel&gt;() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span> &#123;<br>    <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>Tä¸€èˆ¬æ˜¯Databindingå¸ƒå±€å®ç°è‡ªåŠ¨ç”Ÿæˆçš„ç±»</li><li>Eéœ€è¦ç»§æ‰¿äºBaseViewModelï¼Œä¹‹åä¼šè‡ªåŠ¨å®ç°initModelæ–¹æ³•<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainViewModel</span> : <span class="hljs-type">BaseViewModel</span></span>() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initModel</span><span class="hljs-params">()</span></span> &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>initModelåœ¨initViewä¹‹å‰ï¼ŒsetContentViewä¹‹åå®ç°çš„æ–¹æ³•</li><li>ä¹‹åå¯åœ¨activityä¸­ç›´æ¥ä½¿ç”¨mViewModelæ¥è·å–Eçš„å®ä¾‹ï¼Œæ— éœ€åˆå§‹åŒ–</li><li>ä¹Ÿå¯é€šè¿‡getViewModel(modelClass: Class<E>)è·å–ViewModelï¼Œå¹¶å¤šæ¬¡è·å–æ˜¯åŒä¸€ä¸ªViewModelå®ä¾‹<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">Log.e(<span class="hljs-string">&quot;TAG&quot;</span>,<span class="hljs-string">&quot;æµ‹è¯•<span class="hljs-subst">$&#123;getViewModel(MainViewModel::class.java)&#125;</span>&quot;</span>)<br>Log.e(<span class="hljs-string">&quot;TAG&quot;</span>,<span class="hljs-string">&quot;æµ‹è¯•<span class="hljs-subst">$&#123;getViewModel(MainViewModel::class.java)&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure></li></ul><h4 id="é›†æˆBaseFragment"><a href="#é›†æˆBaseFragment" class="headerlink" title="é›†æˆBaseFragment"></a>é›†æˆBaseFragment</h4><ul><li><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">XXFragment</span></span>(<span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> layoutId: <span class="hljs-built_in">Int</span> = è‡ªå®šä¹‰å¸ƒå±€) :<br>    BaseFragment&lt;T : ViewDataBinding, E : BaseViewModel&gt;() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">(fragmentView:<span class="hljs-type">View</span>)</span></span> &#123;<br>    <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li>å…¶ä»–æ€§è´¨å’ŒBaseActivityä¸€æ ·ï¼Œä¸å†é˜è¿°</li></ul><h4 id="MMKVçš„ä½¿ç”¨"><a href="#MMKVçš„ä½¿ç”¨" class="headerlink" title="MMKVçš„ä½¿ç”¨"></a>MMKVçš„ä½¿ç”¨</h4><ul><li>åˆå§‹åŒ–<br>åœ¨Applicationä¸­æ·»åŠ å¦‚ä¸‹ä»£ç å³å¯<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">try</span> &#123;<br>    TaskDispatcher dispatcher = BasicLibraryConfig.Companion.getInstance().getApp().getDispatcher();<br>    dispatcher.start();<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure></li><li>ä½¿ç”¨<br>ä¿å­˜æ•°æ®<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">PreferencesUtils.getInstance(<span class="hljs-keyword">this</span>).saveParams(key,value)<span class="hljs-comment">//ğŸ‘ˆğŸ»key: String, objects: Any</span><br></code></pre></td></tr></table></figure>è·å–æ•°æ®<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">PreferencesUtils.getInstance(this).getParam(key,defalutParams)//ğŸ‘ˆğŸ»key: String, defaultObject: Any?<br></code></pre></td></tr></table></figure></li><li>å…³äºå¯åŠ¨ä¼˜åŒ–â€”â€”å¯åŠ¨å™¨TaskDispatcherå¤§å®¶å¯ä»¥çœ‹æˆ‘ä¹‹å‰å…³äºBasicUIçš„wikiï¼š<a href="https://github.com/Peakmain/BasicUI/wiki/%E6%9C%89%E5%90%91%E6%97%A0%E7%8E%AF%E5%9B%BE%E5%AE%9E%E7%8E%B0%E5%90%AF%E5%8A%A8%E5%99%A8%E4%BC%98%E5%8C%96">æœ‰å‘æ— ç¯å›¾å®ç°å¯åŠ¨å™¨ä¼˜åŒ–</a></li></ul><h4 id="é˜²æ­¢å¤šæ¬¡ç‚¹å‡»äº‹ä»¶çš„å¤„ç†"><a href="#é˜²æ­¢å¤šæ¬¡ç‚¹å‡»äº‹ä»¶çš„å¤„ç†" class="headerlink" title="é˜²æ­¢å¤šæ¬¡ç‚¹å‡»äº‹ä»¶çš„å¤„ç†"></a>é˜²æ­¢å¤šæ¬¡ç‚¹å‡»äº‹ä»¶çš„å¤„ç†</h4><ul><li>ç«‹å³å¤„ç†<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">mBinding.tvTitle.click&#123;<br>    <span class="hljs-comment">//todo äº‹ä»¶å¤„ç†</span><br>&#125;<br></code></pre></td></tr></table></figure>å»¶æ—¶å¤„ç†<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//æˆ–è€…</span><br>mBinding.tvTitle.clickViewDelay&#123;<br>    <span class="hljs-comment">//todo äº‹ä»¶å¤„ç†</span><br>&#125;        <br><br></code></pre></td></tr></table></figure>TextViewäº‹ä»¶çš„æ‹†åˆ†<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">mBinding.tvTitle.clickClipListener( mBinding.tvTitle,leftClick = &#123;<br>      <span class="hljs-comment">//todo drawableLeftçš„ç‚¹å‡»äº‹ä»¶</span><br>&#125;)&#123;<br>    <span class="hljs-comment">//todo drawableRightçš„ç‚¹å‡»äº‹ä»¶</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="å…³äºçº¿ç¨‹åˆ‡æ¢"><a href="#å…³äºçº¿ç¨‹åˆ‡æ¢" class="headerlink" title="å…³äºçº¿ç¨‹åˆ‡æ¢"></a>å…³äºçº¿ç¨‹åˆ‡æ¢</h4>åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">mBinding.tvTitle.ktxRunOnUiThread &#123; <br><br> &#125;<br><br></code></pre></td></tr></table></figure>å»¶è¿ŸdelayMillsåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">mBinding.tvTitle.ktxRunOnUiThreadDelay(delayMills) &#123; <br><br>&#125;<br></code></pre></td></tr></table></figure>å»¶è¿ŸåŠ è½½,é»˜è®¤æ˜¯500ms<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">mBinding.tvTitle.wait &#123; <br>    <br>&#125;<br></code></pre></td></tr></table></figure>å»¶è¿ŸåŠ è½½ï¼Œè®¾ç½®å»¶è¿Ÿæ—¶é—´<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">mBinding.tvTitle.wait(<span class="hljs-number">600</span>) &#123;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>å»¶è¿ŸåŠ è½½ï¼Œè®¾ç½®å»¶è¿Ÿæ—¶é—´å’Œå•ä½<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">mBinding.tvTitle.wait(<span class="hljs-number">600</span>,TimeUnit.SECONDS) &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="Viewçš„æŠ–åŠ¨æ•ˆæœ"><a href="#Viewçš„æŠ–åŠ¨æ•ˆæœ" class="headerlink" title="Viewçš„æŠ–åŠ¨æ•ˆæœ"></a>Viewçš„æŠ–åŠ¨æ•ˆæœ</h4><ul><li><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">View.shakeAnimation( fromXDelta: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>,<br>                     toXDelta: <span class="hljs-built_in">Float</span> = <span class="hljs-number">5f</span>,<br>                     fromYDelta: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>,<br>                     toYDelta: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>,<br>                     duration: <span class="hljs-built_in">Long</span> = <span class="hljs-number">500</span>)<br></code></pre></td></tr></table></figure></li></ul><h4 id="ç½‘ç»œåº“çš„ä½¿ç”¨"><a href="#ç½‘ç»œåº“çš„ä½¿ç”¨" class="headerlink" title="ç½‘ç»œåº“çš„ä½¿ç”¨"></a>ç½‘ç»œåº“çš„ä½¿ç”¨</h4><ul><li>æ¨èåœ¨ViewModelä¸­è¿›è¡Œåˆå§‹åŒ–</li><li>åˆ›å»ºService</li></ul><h5 id="serviceå°±æ˜¯Retrofitè¯·æ±‚ç½‘ç»œå±‚çš„Serviceæ¥å£"><a href="#serviceå°±æ˜¯Retrofitè¯·æ±‚ç½‘ç»œå±‚çš„Serviceæ¥å£" class="headerlink" title="serviceå°±æ˜¯Retrofitè¯·æ±‚ç½‘ç»œå±‚çš„Serviceæ¥å£"></a>serviceå°±æ˜¯Retrofitè¯·æ±‚ç½‘ç»œå±‚çš„Serviceæ¥å£</h5><ul><li><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> api: WanAndroidApi = RetrofitManager.createService(WanAndroidApi::<span class="hljs-keyword">class</span>.java,<span class="hljs-string">&quot;https://wanandroid.com/&quot;</span>)<br></code></pre></td></tr></table></figure></li></ul><h5 id="å¦‚æœæƒ³ç”¨è‡ªå·±çš„å°è£…æ–¹æ³•å®ç°Serviceï¼Œå¯ä»¥è°ƒç”¨ä»¥ä¸‹æ–¹æ³•"><a href="#å¦‚æœæƒ³ç”¨è‡ªå·±çš„å°è£…æ–¹æ³•å®ç°Serviceï¼Œå¯ä»¥è°ƒç”¨ä»¥ä¸‹æ–¹æ³•" class="headerlink" title="å¦‚æœæƒ³ç”¨è‡ªå·±çš„å°è£…æ–¹æ³•å®ç°Serviceï¼Œå¯ä»¥è°ƒç”¨ä»¥ä¸‹æ–¹æ³•"></a>å¦‚æœæƒ³ç”¨è‡ªå·±çš„å°è£…æ–¹æ³•å®ç°Serviceï¼Œå¯ä»¥è°ƒç”¨ä»¥ä¸‹æ–¹æ³•</h5><ul><li><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> api: WanAndroidApi = RetrofitManager.createService(WanAndroidApi::<span class="hljs-keyword">class</span>.java) &#123;<br>    <span class="hljs-comment">//todo è‡ªå·±åˆ›å»ºçš„Service</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>è¯·æ±‚ç½‘ç»œ<br>ç¬¬ä¸€ç§å†™æ³•</p><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">RetrofitManager.createData(api.getList(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>), <span class="hljs-keyword">object</span> : ApiStatus&lt;ApiModel&lt;ProjectBean&gt;&gt;() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">before</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-comment">//todo è°ƒç”¨è¯·æ±‚ç½‘ç»œå‰</span><br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">error</span><span class="hljs-params">(exception: <span class="hljs-type">Exception</span>)</span></span> &#123;<br>       <span class="hljs-comment">//todo è¿”å›é”™è¯¯</span><br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">success</span><span class="hljs-params">(t: <span class="hljs-type">ApiModel</span>&lt;<span class="hljs-type">ProjectBean</span>&gt;)</span></span> &#123;<br>      <span class="hljs-comment">//è¿”å›æˆåŠŸ</span><br>    &#125;<br><br><br>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>ç¬¬äºŒç§å†™æ³•</p><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">RetrofitManager.createData(api.projectTree, &#123;<br>    <span class="hljs-comment">//todo before()</span><br>&#125;, &#123;<br>    <span class="hljs-comment">//todo success(</span><br>&#125;, &#123;<br>    <span class="hljs-comment">//todo error()</span><br>&#125;)<br></code></pre></td></tr></table></figure></li></ul><h4 id="LiveDataå®ç°äº‹ä»¶åˆ†å‘æ€»çº¿"><a href="#LiveDataå®ç°äº‹ä»¶åˆ†å‘æ€»çº¿" class="headerlink" title="LiveDataå®ç°äº‹ä»¶åˆ†å‘æ€»çº¿"></a>LiveDataå®ç°äº‹ä»¶åˆ†å‘æ€»çº¿</h4><ul><li>æ³¨å†Œæˆ–è·å–å®ä¾‹<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> rxBus = RxBus.instance.register&lt;<span class="hljs-built_in">Int</span>&gt;(<span class="hljs-string">&quot;test&quot;</span>)<br></code></pre></td></tr></table></figure></li><li>å‘é€æ•°æ®<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">rxBus.setData(<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure></li><li>æ¥å—æ•°æ®<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> value=rxBus.value<br></code></pre></td></tr></table></figure><h4 id="CommonRecyclerDataBindingAdapter-RecycleViewåœ¨Bindingçš„ä½¿ç”¨"><a href="#CommonRecyclerDataBindingAdapter-RecycleViewåœ¨Bindingçš„ä½¿ç”¨" class="headerlink" title="CommonRecyclerDataBindingAdapter RecycleViewåœ¨Bindingçš„ä½¿ç”¨"></a>CommonRecyclerDataBindingAdapter RecycleViewåœ¨Bindingçš„ä½¿ç”¨</h4><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestAdapter</span></span>(<span class="hljs-keyword">data</span>: MutableList&lt;String&gt;, layoutManager: LinearLayoutManager) :<br>    CommonRecyclerDataBindingAdapter&lt;String, RecyclerAdpterTestBinding&gt;(<br>        <span class="hljs-keyword">data</span>,<span class="hljs-comment">//ğŸ‘ˆğŸ»æ•°æ®æº</span><br>        R.layout.recycler_adpter_test,<span class="hljs-comment">//ğŸ‘ˆè‡ªå®šä¹‰å¸ƒå±€</span><br>        DefaultAdapterFooterConfig&lt;String,RecyclerAdpterTestBinding&gt;(layoutManager).item<span class="hljs-comment">//ğŸ‘ˆæ˜¯å¦æ˜¾ç¤ºåŠ è½½æ›´å¤š,å¦‚æœä¸ºnullï¼Œåˆ™ä¸æ˜¾ç¤ºåŠ è½½æ›´å¤šï¼Œå¯è‡ªå®šä¹‰ï¼Œå¯å‚è€ƒDefaultAdapterFooterConfigçš„æºç </span><br>    ) &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">convert</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">        holder: <span class="hljs-type">BaseLibraryViewHolder</span>&lt;<span class="hljs-type">RecyclerAdpterTestBinding</span>&gt;,</span></span><br><span class="hljs-params"><span class="hljs-function">        itemData: <span class="hljs-type">String</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">        position: <span class="hljs-type">Int</span></span></span><br><span class="hljs-params"><span class="hljs-function">    )</span></span> &#123;<br>        <span class="hljs-keyword">val</span> binding = holder.itemDataBinding<br>        binding.vm = itemData<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="è·å–åç¨‹çš„å…¨å±€å¼‚å¸¸"><a href="#è·å–åç¨‹çš„å…¨å±€å¼‚å¸¸" class="headerlink" title="è·å–åç¨‹çš„å…¨å±€å¼‚å¸¸"></a>è·å–åç¨‹çš„å…¨å±€å¼‚å¸¸</h4><ul><li><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">  GlobalCoroutineExceptionHandler().coroutineExceptionCallback=&#123; context, exception-&gt;<br>       <span class="hljs-comment">//context:CoroutineContext</span><br><span class="hljs-comment">//exception:Throwable</span><br>   &#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="BindingAdapterçš„ä½¿ç”¨"><a href="#BindingAdapterçš„ä½¿ç”¨" class="headerlink" title="BindingAdapterçš„ä½¿ç”¨"></a>BindingAdapterçš„ä½¿ç”¨</h4><ul><li>â‘ ã€æ–‡æœ¬æ·»åŠ *å‰ç¼€<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">app:asteriskPrevText=<span class="hljs-string">&quot;&quot;</span><span class="hljs-comment">//æ–‡æœ¬çš„åå­—</span><br>app:asteriskColor=<span class="hljs-string">&quot;&quot;</span><span class="hljs-comment">//æ˜Ÿå·çš„é¢œè‰²</span><br></code></pre></td></tr></table></figure></li><li>â‘¡ã€è®¾ç½®imageçš„urlå›¾ç‰‡<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">app:loadUrl=<span class="hljs-string">&quot;&quot;</span><span class="hljs-comment">//å‚æ•°url</span><br></code></pre></td></tr></table></figure></li><li>â‘¢ã€è®¾ç½®viewçš„visibilityæ˜¯View.VISIBLEè¿˜æ˜¯View.Gone<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">app:visibilityOrGone=<span class="hljs-string">&quot;@&#123;!vm.isShow&#125;&quot;</span><span class="hljs-comment">//trueè¡¨ç¤ºView.Visible,falseåˆ™è¡¨ç¤ºView.Gone</span><br></code></pre></td></tr></table></figure></li><li>â‘£ã€è®¾ç½®viewçš„visibilityæ˜¯View.VISIBLEè¿˜æ˜¯View.InVisibile<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">app:visibilityOrInVisible=<span class="hljs-string">&quot;@&#123;vm.isShow&#125;&quot;</span><span class="hljs-comment">//trueè¡¨ç¤ºView.Visible,falseåˆ™è¡¨ç¤ºView.InVisbile</span><br><br></code></pre></td></tr></table></figure></li><li>â‘¤ã€é˜²æ­¢å¤šæ¬¡é‡å¤ç‚¹å‡»<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">app:clickDelayTime=<span class="hljs-string">&quot;@&#123;vm.delayTime&#125;&quot;</span><span class="hljs-comment">//è®¾ç½®ç‚¹å‡»äº‹ä»¶çš„å»¶è¿Ÿæ—¶é—´,å‚æ•°ä¸ºlongç±»å‹</span><br>app:click=<span class="hljs-string">&quot;@&#123;vm.clickListener&#125;&quot;</span><span class="hljs-comment">//è®¾ç½®ç‚¹å‡»äº‹ä»¶çš„äº‹ä»¶å¤„ç†</span><br></code></pre></td></tr></table></figure></li><li>â‘¥ã€textViewçš„drawableLeftå’ŒdrawableRightçš„ç‚¹å‡»äº‹ä»¶<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">app:drawableLeftClick=<span class="hljs-string">&quot;&quot;</span><span class="hljs-comment">//drawableLeftçš„ç‚¹å‡»äº‹ä»¶</span><br>app:drawableRightClick=<span class="hljs-string">&quot;&quot;</span><span class="hljs-comment">//drawableRightçš„ç‚¹å‡»äº‹ä»¶</span><br></code></pre></td></tr></table></figure><h4 id="å…³äºæˆ‘"><a href="#å…³äºæˆ‘" class="headerlink" title="å…³äºæˆ‘"></a>å…³äºæˆ‘</h4></li><li>ç®€ä¹¦(<a href="https://www.jianshu.com/u/3ff32f5aea98">https://www.jianshu.com/u/3ff32f5aea98</a>)</li><li>æˆ‘çš„GitHubåœ°å€(<a href="https://links.jianshu.com/go?to=https://github.com/Peakmain">https://github.com/Peakmain</a>)</li></ul>]]></content>
      
      
      <categories>
          
          <category> Android é«˜çº§è¿›é˜¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android å·¥å…·åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BasicUIå¸¸ç”¨UIç»„ä»¶å’Œå®ç”¨å·¥å…·ç±»å°è£…ï¼Œæé«˜Androidå¼€å‘çš„æ•ˆç‡</title>
      <link href="/archives/b5f422e3.html"/>
      <url>/archives/b5f422e3.html</url>
      
        <content type="html"><![CDATA[<p align="center">  <img src="https://s2.loli.net/2022/05/20/kdocZsSmfL98u5H.jpg"  /></p><h4 id="BasicUI"><a href="#BasicUI" class="headerlink" title="BasicUI"></a>BasicUI</h4><hr><p>BasicUIæ˜¯ä¸€äº›å¸¸ç”¨çš„Android UIç»„ä»¶å’Œä¸€äº›å®ç”¨å·¥å…·ç±»å°è£…ï¼Œæé«˜Androidçš„å¼€å‘æ•ˆç‡</p><p><strong>ä½¿ç”¨æ–‡æ¡£é“¾æ¥ï¼š<a href="https://github.com/Peakmain/BasicUI/wiki">https://github.com/Peakmain/BasicUI/wiki</a></strong></p><h4 id="How-to"><a href="#How-to" class="headerlink" title="How to"></a>How to</h4><ul><li>Step 1. Add the JitPack repository to your build file</li></ul><p>Add it in your root build.gradle at the end of repositories:</p><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">allprojects &#123;<br>    repositories &#123;<br>        ...<br>        maven &#123; url <span class="hljs-string">&#x27;https://jitpack.io&#x27;</span> &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>Step 2. Add the dependency</p><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">implementation <span class="hljs-string">&#x27;com.github.Peakmain:BasicUI:1.1.13&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>Step 3.some probleam</p><p>å¦‚æœä½ çš„gradleç‰ˆæœ¬æ¯”3.5.3é«˜ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><p>1ã€Entry name â€˜AndroidManifest.xmlâ€™ collided</p><p><strong>è§£å†³åŠæ³•ï¼šåœ¨gradle.propertiesæ·»åŠ ä»¥ä¸‹ä»£ç </strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">android.useNewApkCreator=false<br></code></pre></td></tr></table></figure><p> 2ã€å¦‚æœå®‰è£…å¤±è´¥ï¼Œç”¨adb installå®‰è£…æŠ¥é”™æç¤ºå¦‚ä¸‹</p><p>  failed to install app-debug.apk: Failure [INSTALL_PARSE_FAILED_UNEXPECTED_EXCEPTION: Failed to parse /data/app/vmdl1335956833.tmp/base.apk: Corrupt XML binary file]</p><p><strong>è§£å†³åŠæ³•:åœ¨æ·»åŠ ä¾èµ–çš„build.gradleä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </strong></p> <figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">android&#123;<br>     packagingOptions &#123;<br>      exclude <span class="hljs-string">&#x27;AndroidManifest.xml&#x27;</span><br>   &#125;<br> &#125;<br></code></pre></td></tr></table></figure><p>3ã€å¦‚æœæç¤ºæŠ¥é”™</p><img width="908" alt="image" src="https://user-images.githubusercontent.com/26482737/167089658-d5176dbc-ae07-4fd3-ac91-8caf6cea7e00.png"> **è§£å†³åŠæ³•:ä¿®æ”¹ä¾èµ–å¦‚ä¸‹** <figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">implementation (<span class="hljs-string">&#x27;com.github.Peakmain:BasicUI:1.1.13&#x27;</span>)&#123;<br>    exclude group:<span class="hljs-string">&quot;com.github.yalantis&quot;</span>,module:<span class="hljs-string">&quot;ucrop&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure> AndroidManifest.xmlæ·»åŠ å¦‚ä¸‹ä»£ç  <figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">&lt;activity android:name=<span class="hljs-string">&quot;com.yalantis.ucrop.UCropActivity&quot;</span> tools:node=<span class="hljs-string">&quot;remove&quot;</span>/&gt;<br></code></pre></td></tr></table></figure></li></ul><h5 id="Screenshot"><a href="#Screenshot" class="headerlink" title="Screenshot"></a>Screenshot</h5><p><img src="https://s2.loli.net/2022/05/20/jsTRSLnecMdHXI6.jpg" alt="é¦–é¡µ.jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/3zH8rtYXSkdi7FO.jpg" alt="dialogçš„ä½¿ç”¨.jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/weYaR76PlZu1j2I.jpg" alt="navigtionBarçš„ä½¿ç”¨.jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/axsQmFJzoH8cj9S.jpg" alt="popwindow_flowlayoutçš„ä½¿ç”¨.jpg">&emsp;<br><img src="https://s2.loli.net/2022/05/20/sfvtMgPYUuzjo4n.jpg" alt="è‡ªå¸¦åˆ é™¤çš„EditText.jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/39aOy8McqkhvQiZ.jpg" alt="TextViewçš„å°è£….jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/tvqV9KBywXEdYNa.gif" alt="ä»¿ä»Šæ—¥å¤´æ¡çš„TableLayout.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/COq9DSpxAkB2moa.gif" alt="åŠ è½½loading.gif">&emsp;<br><img src="https://s2.loli.net/2022/05/20/Hr6K2xmUZf4uhlN.gif" alt="å¤šæ¡ç›®èœå•åˆ é€‰.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/ojZlznW7IfSOkQV.jpg" alt="è‡ªå®šä¹‰é”®ç›˜.jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/bfGpYsd5tTC3cgl.jpg" alt="LinearlayoutManageråˆ†ç»„.jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/xhVrCGeLqIyZPgt.gif" alt="LinearlayoutManageræ‚¬æµ®.gif">&emsp;<br><img src="https://s2.loli.net/2022/05/20/gnUKSxbL6sXwlDf.jpg" alt="GridLayoutManageråˆ†ç»„.jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/fhVOBZbFAnmGqCe.gif" alt="GridLayoutManageræ‚¬æµ®.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/Oej3WGVTCg5Uczy.gif" alt="ItemTouchHelpå®ç°åˆ é™¤å’ŒåœŸæ‹–æ‹½.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/wOxc1dfTvRWBVP3.gif" alt="RecyclerViewå®ç°ä¸‹æ‹‰åˆ·æ–°å’ŒåŠ è½½æ›´å¤š2.gif">&emsp;<br><img src="https://s2.loli.net/2022/05/20/cHhQPRge8CjNTWA.gif" alt="RecyclerViewå®ç°ä¸‹æ‹‰åˆ·æ–°å’ŒåŠ è½½1.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/e32cT4jPxC1Atul.gif" alt="RecyclerViewå®ç°å¤šçŠ¶æ€å¸ƒå±€.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/apo9PiRuKDH4FfN.gif" alt="å›¾ç‰‡å‹ç¼©.gif">&emsp;<img src="../img/å›¾ç‰‡é€‰æ‹©.gif"></img>&emsp;<br><img src="https://s2.loli.net/2022/05/20/z6xqems7tQRfPAW.gif" alt="æ–‡ä»¶é€‰æ‹©.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/pLaHbo1vgl6SYWn.gif" alt="é€‰æ‹©å™¨çš„ä½¿ç”¨.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/brzdTNfvh5SlwF6.gif" alt="glideçš„ä½¿ç”¨.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/qz3gbaorfAZncPC.jpg" alt="Viewåˆ›å»ºBitmap.jpg">&emsp;<br><img src="https://s2.loli.net/2022/05/20/PAtYjZqXJ8o2SpL.jpg" alt="OkHttpçš„å°è£….jpg">&emsp;<img src="https://s2.loli.net/2022/05/20/4koeM6L2DRJEqGN.gif" alt="æ–‡æœ¬é«˜äº®çš„ä½¿ç”¨.gif">&emsp;<img src="https://s2.loli.net/2022/05/20/dsuOp3hTBgiyZv8.jpg" alt="æˆ‘çš„.jpg">&emsp;</p><h4 id="BasicUI-Demo-APP-å®‰è£…åŒ…ä¸‹è½½"><a href="#BasicUI-Demo-APP-å®‰è£…åŒ…ä¸‹è½½" class="headerlink" title="BasicUI Demo APP å®‰è£…åŒ…ä¸‹è½½"></a>BasicUI Demo APP å®‰è£…åŒ…ä¸‹è½½</h4><hr><ul><li>è’²å…¬è‹±ä¸‹è½½åœ°å€</li></ul><p> <img src="https://www.pgyer.com/app/qrcode/BasicUI" alt="æ¼”ç¤ºdemo"></p><ul><li>Githubä¸‹è½½åœ°å€ï¼š</li></ul><p><img src="https://s2.loli.net/2022/05/20/Ye1gBWxMXNUAZSO.png" alt="äºŒç»´ç .png"></p><h4 id="å…³äºæˆ‘"><a href="#å…³äºæˆ‘" class="headerlink" title="å…³äºæˆ‘"></a>å…³äºæˆ‘</h4><ul><li>ç®€ä¹¦ï¼šÂ <a href="https://www.jianshu.com/u/3ff32f5aea98">https://www.jianshu.com/u/3ff32f5aea98</a></li><li>æˆ‘çš„GitHubåœ°å€ï¼š<a href="https://github.com/Peakmain">https://github.com/Peakmain</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Android é«˜çº§è¿›é˜¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android UI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gradle æ’ä»¶ + ASM å®æˆ˜â€”â€”å…¥é—¨ç¯‡</title>
      <link href="/archives/4d06e308.html"/>
      <url>/archives/4d06e308.html</url>
      
        <content type="html"><![CDATA[<h4 id="åŸºæœ¬é¡¹ç›®æ­å»º"><a href="#åŸºæœ¬é¡¹ç›®æ­å»º" class="headerlink" title="åŸºæœ¬é¡¹ç›®æ­å»º"></a>åŸºæœ¬é¡¹ç›®æ­å»º</h4><ul><li><p>é¡¹ç›®æ–°å»ºä¸€ä¸ªAndroid Moduleï¼Œå–åä¸ºplugin</p></li><li><p>åˆ é™¤æ— ç”¨èµ„æºï¼Œæ–°å»ºgroovyã€resources/META-INF/gradle-pluginsç›®å½•<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125513215ASM+Gradle%E5%85%A5%E9%97%A811.png" alt="image.png"></p></li><li><p>ä¿®æ”¹build.gradle</p><figure class="highlight gradle"><table><tr><td class="code"><pre><code class="hljs gradle">apply plugin: <span class="hljs-string">&#x27;groovy&#x27;</span><br>apply plugin: <span class="hljs-string">&#x27;maven&#x27;</span><br><span class="hljs-keyword">dependencies</span> &#123;<br>    implementation gradleApi()<br>    implementation localGroovy()<br><br>    implementation <span class="hljs-string">&#x27;org.ow2.asm:asm:7.1&#x27;</span><br>    implementation <span class="hljs-string">&#x27;org.ow2.asm:asm-commons:7.1&#x27;</span><br>    implementation <span class="hljs-string">&#x27;org.ow2.asm:asm-analysis:7.1&#x27;</span><br>    implementation <span class="hljs-string">&#x27;org.ow2.asm:asm-util:7.0&#x27;</span><br>    implementation <span class="hljs-string">&#x27;org.ow2.asm:asm-tree:7.1&#x27;</span><br>    compileOnly <span class="hljs-string">&#x27;com.android.tools.build:gradle:3.4.1&#x27;</span>, &#123;<br>        <span class="hljs-keyword">exclude</span> <span class="hljs-keyword">group</span>:<span class="hljs-string">&#x27;org.ow2.asm&#x27;</span><br>    &#125;<br>&#125;<br><span class="hljs-keyword">repositories</span> &#123;<br>    jcenter()<br>&#125;<br><br>uploadArchives &#123;<br>    <span class="hljs-keyword">repositories</span>.mavenDeployer &#123;<br>        <span class="hljs-comment">//æœ¬åœ°ä»“åº“è·¯å¾„ï¼Œä»¥æ”¾åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ repo çš„æ–‡ä»¶å¤¹ä¸ºä¾‹</span><br>        repository(url: uri(<span class="hljs-string">&#x27;../repo&#x27;</span>))<br><br>        <span class="hljs-comment">//groupId</span><br>        pom.groupId = <span class="hljs-string">&#x27;com.peakmain&#x27;</span><br><br>        <span class="hljs-comment">//artifactId</span><br>        pom.artifactId = <span class="hljs-string">&#x27;android.plugin&#x27;</span><br><br>        <span class="hljs-comment">//æ’ä»¶ç‰ˆæœ¬å·</span><br>        pom.version = <span class="hljs-string">&#x27;1.0.0&#x27;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>groovyç›®å½•æ–°å»ºä¸€ä¸ªæ–‡ä»¶BuryPointPlugin.groovyå¹¶æ”¾åˆ°com.peakmain.analytics.pluginç›®å½•ä¸‹<br>è¿™ä¸ªä¾¿æ˜¯æˆ‘ä»¬çš„å…¥å£äº†ï¼Œç¨‹åºä¸€ç¼–è¯‘æˆ‘ä»¬å°±ä¼šæ¥åˆ°è¿™é‡Œå¹¶è°ƒç”¨applyæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BuryPointPlugin</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Plugin</span>&lt;Project&gt;&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(Project project)</span> &#123;<br>          println(<span class="hljs-string">&quot;æ¬¢è¿æ¥åˆ°gradleæ’ä»¶&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>resourcesä¸‹æ–°å»ºä¸€ä¸ªcom.peakmain.plugin.propertiesæ–‡ä»¶ï¼Œæ³¨æ„ï¼šcom.peakmain.pluginæ˜¯æˆ‘ä»¬å¼•å…¥çš„æ’ä»¶çš„åå­—ï¼Œpropertiesæ˜¯åç¼€<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125398477ASM+Gradle%E5%85%A5%E9%97%A81.png" alt="image.png"></p></li><li><p>æ¥åˆ°Android Studioçš„å³ä¸Šè§’Gradleï¼Œé€‰æ‹©module pluginçš„Tasks<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125607077ASM+Gradle%E5%85%A5%E9%97%A82.png" alt="image.png"><br>åŒå‡»ä¹‹åæˆ‘ä»¬åœ¨Android Studioç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°æ–‡ä»¶å¤¹[repo]<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125608077ASM+Gradle%E5%85%A5%E9%97%A83.png" alt="image.png"></p></li><li><p>ä¿®æ”¹æ ¹ç›®å½•çš„build.gradle<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125609078ASM+Gradle%E5%85%A5%E9%97%A84.png" alt="image.png"></p></li><li><p>ä¿®æ”¹appçš„build.gradle</p><figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin">apply plugin: <span class="hljs-string">&#x27;com.peakmain.plugin&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>é‡æ–°buildä¹‹åçœ‹åˆ°è¿™è¡Œæ‰“å°å°±ä»£è¡¨æˆåŠŸäº†<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125610077ASM+Gradle%E5%85%A5%E9%97%A85.png" alt="image.png"></p></li></ul><h4 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h4><ul><li>æˆ‘ä»¬åœ¨build.gradleé€šå¸¸ä¼šçœ‹åˆ°è¿™äº›æ‰©å±•<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125611077ASM+Gradle%E5%85%A5%E9%97%A86.png" alt="image.png"></li></ul><p>å¦‚æœæˆ‘ä»¬æƒ³æˆ‘ä»¬çš„é¡¹ç›®ä¹Ÿæ·»åŠ ä¸€ä¸ªæ‰©å±•ï¼Œåº”è¯¥æ€ä¹ˆåš?</p><ul><li>groovyç›®å½•æ–°å»ºä¸€ä¸ªBuryPointExtension.groovy<figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BuryPointExtension</span></span>&#123;<br>    boolean disableAppClick = <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure>ä¿®æ”¹BuryPointPluginæºç <figure class="highlight kotlin"><table><tr><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Override</span><br>void apply(Project project) &#123;<br>    project.extensions.create(<span class="hljs-string">&quot;peakmainPlugin&quot;</span>, BuryPointExtension)<br>&#125;<br></code></pre></td></tr></table></figure></li><li>é‡æ–°uploadArchivesä¹‹ååœ¨appçš„build.gradleå°±å¯ä»¥ä½¿ç”¨äº†<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125612077ASM+Gradle%E5%85%A5%E9%97%A87.png" alt="image.png"></li></ul><p><strong>gradle.propertiesä¸­è®¾ç½®ä¾èµ–</strong></p><ul><li><p>ä¸Šé¢æˆ‘ä»¬åœ¨appçš„gradleä¸­è®¾ç½®æ‰©å±•ä¾èµ–peakmainPlugin,é‚£å¦‚æœæˆ‘ä»¬æƒ³åœ¨gradle.propertiesä¸­è®¾ç½®ï¼Œå¦‚ä½•åšå‘¢ï¼Ÿ<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125612077ASM+Gradle%E5%85%A5%E9%97%A87.png" alt="image.png"></p></li><li><p>ä¿®æ”¹BuryPointPluginæºç </p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BuryPointPlugin</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Plugin</span>&lt;Project&gt; &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(Project project)</span> &#123;<br>        <span class="hljs-type">BuryPointExtension</span> <span class="hljs-variable">extension</span> <span class="hljs-operator">=</span> project.extensions.create(<span class="hljs-string">&quot;peakmainPlugin&quot;</span>, BuryPointExtension)<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">disableBuryPointPlugin</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span><br>        <span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>()<br>        <span class="hljs-comment">//gradle.propertiesæ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span>(project.rootProject.file(<span class="hljs-string">&#x27;gradle.properties&#x27;</span>).exists())&#123;<br>             <span class="hljs-comment">//gradle.propertiesæ–‡ä»¶-&gt;è¾“å…¥æµ</span><br>            properties.load(project.rootProject.file(<span class="hljs-string">&#x27;gradle.properties&#x27;</span>).newDataInputStream())<br>            disableBuryPointPlugin=Boolean.parseBoolean(properties.getProperty(<span class="hljs-string">&quot;peakmainPlugin.disableAppClick&quot;</span>,<span class="hljs-string">&quot;false&quot;</span>))<br>        &#125;<br>        <span class="hljs-comment">//å¦‚æœdisableBuryPointPluginå¯ç”¨</span><br>        <span class="hljs-keyword">if</span>(!disableBuryPointPlugin)&#123;<br>           println(<span class="hljs-string">&quot;æ¬¢è¿æ¥åˆ°peakmainPlugin&quot;</span>)<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            println(<span class="hljs-string">&quot;------------æ‚¨å·²å…³é—­äº†åŸ‹ç‚¹æ’ä»¶--------------&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹ç»“æœ<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125614077ASM+Gradle%E5%85%A5%E9%97%A89.png" alt="image.png"></p></li><li><p>ä¿®æ”¹gralde.propertiesä¸­çš„å±æ€§çš„å€¼å¹¶æŸ¥çœ‹ç»“æœ<br><img src="https://cdn.jsdelivr.net/gh/Peakmain/image@main/img/gradle%E5%92%8CASM/1653125615079ASM+Gradle%E5%85%A5%E9%97%A810.png" alt="image.png"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Gradleå’ŒASM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gradle </tag>
            
            <tag> asm </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
